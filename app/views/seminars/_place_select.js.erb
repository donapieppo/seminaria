<%= javascript_tag do %>  
  $(function(){
    // place_id: array of rooms
    // { 10: [1,2,4], 20: [3,7] }
    place_to_rooms = <%= raw place_and_room_json_hash %>

    function show_place_rooms() {
      place_id = $("select#seminar_place_id option:selected").val();
      // place_id == 0 means define room by hand
      if (place_id == 0) {
        $(".seminar_room_description").show();
        $(".seminar_room").hide();
      } else {
        $(".seminar_room_description").hide(); // no description
        $(".seminar_room").show();             // show what to choose

        $("#seminar_room option").hide();      // hide all and than show rooms in place_id

        // unselect all and select the first
        $("#seminar_room option").attr('selected',false); // unselect previously selected
        $("#seminar_room option[value=" + place_to_rooms[place_id][0] + "]").attr('selected',true);
        place_to_rooms[place_id].forEach(function(element, index, array) {
          $("#seminar_room option[value=" + element + "]").show();
        });
      };
    }

    $("select#seminar_place_id").change(function() {
      show_place_rooms();
    });

    show_place_rooms();
  });
<% end %>

